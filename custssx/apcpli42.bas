*       ****************************************************************~
*                  ( As of 11/14/97 - RHH Checked for R6.04.03 )       *~
*        APCPLI42 - (1%) Calculate Tube Windings for 600 Series.       *~
*                   (2%) Avaliable for other Depts                     *~
*                                                                      *~
*            Note - Balance Winding Chart Changed. Mod to TT$()        *~
*                   made 11/17/93 - RHH                                *~
*                 - Mod to Modify Heights (1 and 2) for Cottage and    *~
*                   Oriel Windows. - 06/02/94                          *~
*                 - Mod to Number of turns for Tube Length.            *~
*                   ( 7 - 13 ) Add One (1) Turn ( 6/20/97 )            *~
*                   (34 - 45 ) Add Two (2) Turns ( 6/20/97 )           *~
*                                                                      *~
*            Note - Clean-Up Tempered Glass Test.                      *~
*                                                                      *~
*                                                                      *~
*       ****************************************************************

        sub "APCPLI42" (opt%,            /* Option(s) 1 or 2          */ ~
                        gs$,             /* Glass Code                */ ~
                        s_height,        /* Window Height             */ ~
                        s_width,         /* Window Width              */ ~
                        w1$,             /* HT1 - Height 1            */ ~
                        w2$,             /* HT2 - Height 2            */ ~
                        w3$,             /* No of Turns               */ ~
                        mod$,            /* Model for OPT% = 1%       */ ~
                        wind$,           /* Number of Winds           */ ~
                        flg$ )           /* C = Cottage, O = Oriel    */
                                         /* Blank means N/A           */

        dim th(40%),                     /* Tube Length - Height       */~
            tf$(40%)5,                   /* Tube Length - HT1 AND HT2  */~
            tt$(40%)44,                  /* Tube Length - Winds        */~
            tw(22%),                     /* Tube Length - Width        */~
            w1$3,                        /* HT1 - Height 1             */~
            w2$3,                        /* HT2 - Height 2             */~
            w3$3,                        /* No. of Turns               */~
            wind$2,                      /* Number of Winds            */~
            flg$1, x$2,                  /* Cottage/Oriel Flag         */~
            gs$2,                        /* Glass Code                 */~
            temp$50,                     /* Pos = "*" for Tempered Gls */~
            mod$3                        /* Model (510,511)            */

            if opt% <> 1% then goto exit_sub
        REM - 8, 13, 16, 18, 19, 23, 24, 25, 27, 28, 29
               temp$ = "       *    *  * **   *** ***          "

               th( 1%) = 21.0 : tf$( 1%) = " 6- 8" : tw( 1%) = 16.0
               th( 2%) = 23.0 : tf$( 2%) = " 7- 9" : tw( 2%) = 18.0
               th( 3%) = 25.0 : tf$( 3%) = " 8-10" : tw( 3%) = 20.0
               th( 4%) = 27.0 : tf$( 4%) = " 9-11" : tw( 4%) = 22.0
               th( 5%) = 29.0 : tf$( 5%) = "10-12" : tw( 5%) = 24.0
               th( 6%) = 31.0 : tf$( 6%) = "11-13" : tw( 6%) = 26.0
               th( 7%) = 33.0 : tf$( 7%) = "12-14" : tw( 7%) = 28.0
               th( 8%) = 35.0 : tf$( 8%) = "13-15" : tw( 8%) = 30.0
               th( 9%) = 37.0 : tf$( 9%) = "14-16" : tw( 9%) = 32.0
               th(10%) = 39.0 : tf$(10%) = "15-17" : tw(10%) = 34.0
               th(11%) = 41.0 : tf$(11%) = "16-18" : tw(11%) = 36.0
               th(12%) = 43.0 : tf$(12%) = "17-19" : tw(12%) = 38.0
               th(13%) = 45.0 : tf$(13%) = "18-20" : tw(13%) = 40.0
               th(14%) = 47.0 : tf$(14%) = "19-21" : tw(14%) = 42.0
               th(15%) = 49.0 : tf$(15%) = "20-22" : tw(15%) = 44.0
               th(16%) = 51.0 : tf$(16%) = "21-23" : tw(16%) = 46.0
               th(17%) = 53.0 : tf$(17%) = "22-24" : tw(17%) = 48.0
               th(18%) = 55.0 : tf$(18%) = "23-25" : tw(18%) = 50.0
               th(19%) = 57.0 : tf$(19%) = "24-26" : tw(19%) = 52.0
               th(20%) = 59.0 : tf$(20%) = "25-27" : tw(20%) = 54.0
               th(21%) = 61.0 : tf$(21%) = "26-28" : tw(21%) = 56.0
               th(22%) = 63.0 : tf$(22%) = "27-29" : tw(22%) = 99.0
               th(23%) = 65.0 : tf$(23%) = "28-30"
               th(24%) = 67.0 : tf$(24%) = "29-31"
               th(25%) = 69.0 : tf$(25%) = "30-32"
               th(26%) = 71.0 : tf$(26%) = "31-33"
               th(27%) = 73.0 : tf$(27%) = "32-34"
               th(28%) = 75.0 : tf$(28%) = "33-35"
               th(29%) = 77.0 : tf$(29%) = "34-36"
               th(30%) = 79.0 : tf$(30%) = "35-37"
               th(31%) = 81.0 : tf$(31%) = "36-38"
               th(32%) = 83.0 : tf$(32%) = "37-39"
               th(33%) = 85.0 : tf$(33%) = "38-40"
               th(34%) = 87.0 : tf$(34%) = "39-41"
               th(35%) = 89.0 : tf$(35%) = "40-42"
               th(36%) = 91.0 : tf$(36%) = "41-43"
               th(37%) = 93.0 : tf$(37%) = "42-44"
               th(38%) = 99.0 : tf$(38%) = "42-44"

        REM               " 1 2 3 4 5 6 7 8 910111213141516171819202122"
               tt$( 1%)=  " 1 1 1 2 2 2 2 2 2 2 2 3 3 3 3 3 3 2 2 2 2 2"
               tt$( 2%)=  " 2 2 2 3 3 3 3 3 3 3 4 4 4 4 4 4 4 3 3 3 3 3"
               tt$( 3%)=  " 2 2 2 3 3 3 3 3 3 4 4 4 4 4 4 4 4 3 3 3 3 3"
               tt$( 4%)=  " 2 2 2 3 3 3 3 4 4 4 4 4 4 4 4 4 4 3 3 4 4 4"
               tt$( 5%)=  " 2 2 2 3 3 3 4 4 4 4 4 4 4 4 4 4 4 3 4 4 4 4"
               tt$( 6%)=  " 2 2 2 3 3 4 4 4 4 4 4 4 4 4 4 5 5 4 4 4 4 4"
               tt$( 7%)=  " 2 2 2 3 4 4 4 4 4 4 4 4 4 5 5 5 5 4 4 4 4 4"
        REM               " 1 2 3 4 5 6 7 8 910111213141516171819202122"
               tt$( 8%)=  " 2 2 3 3 4 4 4 4 4 4 4 4 5 5 5 5 5 4 4 4 4 4"
               tt$( 9%)=  " 1 2 2 3 3 3 3 3 3 3 3 4 4 4 4 4 4 3 3 4 4 4"
               tt$(10%)=  " 1 2 2 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4"
               tt$(11%)=  " 1 2 2 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4"
               tt$(12%)=  " 2 2 2 3 3 3 3 3 3 4 4 4 4 4 4 5 5 4 4 4 5 5"
               tt$(13%)=  " 2 2 2 3 3 3 3 3 4 4 4 4 4 4 5 5 5 4 4 5 5 5"
               tt$(14%)=  " 2 2 2 3 3 3 3 4 4 4 4 4 4 5 5 5 5 4 5 5 5 5"
        REM               " 1 2 3 4 5 6 7 8 910111213141516171819202122"
               tt$(15%)=  " 1 1 1 3 3 3 4 4 4 4 4 4 5 5 5 5 5 4 4 4 5 5"
               tt$(16%)=  " 1 1 1 3 3 3 4 4 4 4 4 5 5 5 5 5 5 4 4 5 5 5"
               tt$(17%)=  " 1 1 1 2 3 3 3 3 3 3 3 4 4 4 4 4 4 3 4 4 4 4"
               tt$(18%)=  " 1 1 1 2 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4"
               tt$(19%)=  " 1 1 2 2 3 3 3 3 3 4 4 4 4 4 4 4 5 4 4 4 4 4"
               tt$(20%)=  " 1 1 2 3 3 3 3 3 3 4 4 4 4 4 4 5 5 4 4 4 4 4"
               tt$(21%)=  " 1 1 2 3 3 3 3 4 4 4 4 5 5 5 5 6 7 4 4 4 4 4"
        REM               " 1 2 3 4 5 6 7 8 910111213141516171819202122"
               tt$(22%)=  " 1 2 2 3 3 3 3 4 4 4 5 5 5 5 6 6 7 4 4 4 4 4"
               tt$(23%)=  " 1 2 2 3 3 3 3 4 4 4 5 5 5 6 6 7 7 4 4 4 4 4"
               tt$(24%)=  " 1 2 2 3 3 3 4 4 4 4 5 5 5 6 7 7 7 4 4 4 4 4"
               tt$(25%)=  " 1 2 2 3 3 3 4 4 4 5 5 5 6 6 7 7 8 4 4 4 4 4"
               tt$(26%)=  " 1 2 2 3 4 4 4 4 5 5 5 6 6 7 7 8 8 4 4 4 4 4"
               tt$(27%)=  " 3 3 3 2 2 3 3 3 4 4 4 4 4 4 4 5 5 5 5 5 5 5"
               tt$(28%)=  " 3 3 3 2 3 4 4 5 6 6 5 4 4 5 5 5 5 5 5 5 5 5"
        REM               " 1 2 3 4 5 6 7 8 910111213141516171819202122"
               tt$(29%)=  " 5 5 5 5 5 6 6 7 8 8 8 6 7 7 7 7 7 7 7 7 8 8"
               tt$(30%)=  " 5 5 5 5 6 6 7 7 8 8 8 6 7 7 7 7 7 7 7 7 8 8"
               tt$(31%)=  " 5 5 5 5 6 6 7 8 8 8 8 7 7 7 7 7 7 7 7 8 8 8"
               tt$(32%)=  " 5 5 5 5 6 6 7 8 8 8 8 7 7 7 7 7 7 7 8 8 8 8"
               tt$(33%)=  " 5 5 5 5 6 7 7 8 8 8 8 7 7 7 7 7 7 7 8 8 8 8"
               tt$(34%)=  " 5 5 5 6 6 7 8 8 8 8 8 7 7 7 7 7 7 8 8 8 8 8"
               tt$(35%)=  " 5 5 5 6 6 7 8 8 8 8 8 7 7 7 7 7 7 8 8 8 8 8"
               tt$(36%)=  " 5 5 5 6 6 7 8 8 8 8 8 7 7 7 7 7 8 8 8 8 9 9"
               tt$(37%)=  " 5 5 5 6 7 7 8 9 8 8 8 7 7 7 7 7 8 8 8 8 9 9"
               tt$(38%)=  " 5 5 5 6 7 7 8 9 8 8 8 7 7 7 7 7 8 8 8 8 9 9"

               for i% = 1% to 38%
                   if s_height > th(i%) then goto L01340
                      goto L01350
L01340:        next i%
L01350:        for j% = 1% to 22%
                   if s_width >= tw(j%) then goto L01380
                      goto L01390
L01380:        next j%
L01390:        w1$ = " " & str(tf$(i%),1%,2%)
               w2$ = " " & str(tf$(i%),4%,2%)
               w3$ = "   "
               str(w3$,1%,2%) = str(tt$(i%),(j% * 2%) - 1%, 2%)
               if j% > 16% or i% > 26% then str(w3$,3%,1%) = "H"
                                        /* Tempered Glass - Heavy Duty */
               gs% = 0%
               convert gs$ to gs%, data goto L01470
L01470:
               if gs% = 0% then goto L01510
                  if str(temp$,gs%,1%) = "*" then str(w3$,3%,1%) = "H"

L01510:        if flg$ = "O" then gosub check_oriel
               if flg$ = "C" then gosub check_cottage
               goto exit_sub                        /* Finished - Exit */

        check_oriel
             x = 0.0                                   /* Oriel Window */
             convert w2$ to x, data goto L01580          /* Change HT2   */
L01580:
             x = x * 1.2
             x% = int(x)
             convert x% to x$, pic(00)
             w2$ = " " & x$
        return
        check_cottage
             x = 0.0                                 /* Cottage Window */
             convert w1$ to x, data goto L01670        /* Change HT1     */
L01670:
             x = x * .8
             x% = int(x)
             convert x% to x$, pic(00)
             w1$ = " " & x$
        return

        exit_sub
        end

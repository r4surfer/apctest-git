REM         +---------------------------------------------------------------+
REM         | copy models from catelog 000 to all others.                   |
REM         +---------------------------------------------------------------+


        dim                              /* FILE = APCPLNDT            */~
            pc_rec$(3)256         /* Detail Record              */

        dim f2%(40%),                    /* = 0 if the file is open    */~
            f1%(40%),                    /* = 1 if READ was successful */~
            fs%(40%),                    /* = 1 if file open, -1 if it */~
            pc_key$9,                    /*   doesn't exist, or 0 if   */~
            sv_key$9,                    /*   doesn't exist, or 0 if   */~
            rslt$(40%)20                 /* Text from file opening     */ 
            
            

        dim                              /* (AWD083)                   */~
            cat$(441)4,                  /* Calling Program Flag       */~
            mdl$(03)3                                                     

       dim logmsg$256

       dim new$3 
            mat f2% = con

                     /* The variable F2%() should not be modified.     */
                     /* FS%() also should not be modified (see         */
                     /* OPENCHCK).                                     */

        REM *************************************************************~
            *                  S E L E C T   F I L E S                  *~
            *                                                           *~
            *-----+----------+------------------------------------------*~
            *FILE#!  PRNAME  ! D E S C R I P T I O N                    *~
            *-----+----------+------------------------------------------*~
            * #1  ! APCPCMSD ! Pricing Master Definition File (New)     *~
            *************************************************************~
            *       File Selection and Open Calls                       *~
            *************************************************************

            select #1, "APCPCMSD",                                      ~
                        varc,     indexed,  recsize =   768,            ~
                        keypos =    1, keylen = 9                        

            call "OPENCHCK" (#1, fs%(1%), f2%(1%),500%, rslt$(1%))

            mat f1% = zer
            upd% = 0%
            add% = 0%
            tst% = 0%
	    cnt% = 0%           

            mdl$(01) = "C12"
            mdl$(02) = "C18"
            mdl$(03) = "E21"

            cat$(1) = "0011"
            cat$(2) = "0012"
            cat$(3) = "0017"
            cat$(4) = "0021"
            cat$(5) = "0024"
            cat$(6) = "0039"
            cat$(7) = "0040"
            cat$(8) = "0047"
            cat$(9) = "0048"
            cat$(10) = "0049"
            cat$(11) = "0059"
            cat$(12) = "0066"
            cat$(13) = "0067"
            cat$(14) = "0073"
            cat$(15) = "0076"
            cat$(16) = "0079"
            cat$(17) = "0080"
            cat$(18) = "0086"
            cat$(19) = "0087"
            cat$(20) = "0090"
            cat$(21) = "0094"
            cat$(22) = "0095"
            cat$(23) = "0097"
            cat$(24) = "0099"
            cat$(25) = "0105"
            cat$(26) = "0106"
            cat$(27) = "0108"
            cat$(28) = "0110"
            cat$(29) = "0114"
            cat$(30) = "0116"
            cat$(31) = "0119"
            cat$(32) = "0122"
            cat$(33) = "0124"
            cat$(34) = "0155"
            cat$(35) = "0158"
            cat$(36) = "0165"
            cat$(37) = "0171"
            cat$(38) = "0172"
            cat$(39) = "0186"
            cat$(40) = "0188"
            cat$(41) = "0191"
            cat$(42) = "0199"
            cat$(43) = "0200"
            cat$(44) = "0206"
            cat$(45) = "0209"
            cat$(46) = "0213"
            cat$(47) = "0216"
            cat$(48) = "0221"
            cat$(49) = "0247"
            cat$(50) = "0254"
            cat$(51) = "0257"
            cat$(52) = "0265"
            cat$(53) = "0268"
            cat$(54) = "0272"
            cat$(55) = "0276"
            cat$(56) = "0285"
            cat$(57) = "0286"
            cat$(58) = "0287"
            cat$(59) = "0288"
            cat$(60) = "0295"
            cat$(61) = "0297"
            cat$(62) = "0304"
            cat$(63) = "0314"
            cat$(64) = "0320"
            cat$(65) = "0321"
            cat$(66) = "0322"
            cat$(67) = "0323"
            cat$(68) = "0326"
            cat$(69) = "0333"
            cat$(70) = "0343"
            cat$(71) = "0349"
            cat$(72) = "0354"
            cat$(73) = "0357"
            cat$(74) = "0358"
            cat$(75) = "0362"
            cat$(76) = "0364"
            cat$(77) = "0367"
            cat$(78) = "0376"
            cat$(79) = "0381"
            cat$(80) = "0382"
            cat$(81) = "0384"
            cat$(82) = "0389"
            cat$(83) = "0390"
            cat$(84) = "0392"
            cat$(85) = "0394"
            cat$(86) = "0398"
            cat$(87) = "0399"
            cat$(88) = "0400"
            cat$(89) = "0403"
            cat$(90) = "0405"
            cat$(91) = "0407"
            cat$(92) = "0409"
            cat$(93) = "0410"
            cat$(94) = "0412"
            cat$(95) = "0414"
            cat$(96) = "0415"
            cat$(97) = "0419"
            cat$(98) = "0422"
            cat$(99) = "0423"
            cat$(100) = "0425"
            cat$(101) = "0426"
            cat$(102) = "0448"
            cat$(103) = "0449"
            cat$(104) = "0452"
            cat$(105) = "0453"
            cat$(106) = "0456"
            cat$(107) = "0460"
            cat$(108) = "0464"
            cat$(109) = "0466"
            cat$(110) = "0467"
            cat$(111) = "0468"
            cat$(112) = "0475"
            cat$(113) = "0480"
            cat$(114) = "0481"
            cat$(115) = "0482"
            cat$(116) = "0485"
            cat$(117) = "0492"
            cat$(118) = "0493"
            cat$(119) = "0495"
            cat$(120) = "0496"
            cat$(121) = "0497"
            cat$(122) = "0500"
            cat$(123) = "0502"
            cat$(124) = "0505"
            cat$(125) = "0506"
            cat$(126) = "0513"
            cat$(127) = "0514"
            cat$(128) = "0516"
            cat$(129) = "0517"
            cat$(130) = "0520"
            cat$(131) = "0521"
            cat$(132) = "0527"
            cat$(133) = "0530"
            cat$(134) = "0538"
            cat$(135) = "0542"
            cat$(136) = "0545"
            cat$(137) = "0549"
            cat$(138) = "0552"
            cat$(139) = "0555"
            cat$(140) = "0556"
            cat$(141) = "0557"
            cat$(142) = "0558"
            cat$(143) = "0560"
            cat$(144) = "0561"
            cat$(145) = "0562"
            cat$(146) = "0566"
            cat$(147) = "0568"
            cat$(148) = "0573"
            cat$(149) = "0577"
            cat$(150) = "0578"
            cat$(151) = "0584"
            cat$(152) = "0589"
            cat$(153) = "0590"
            cat$(154) = "0595"
            cat$(155) = "0598"
            cat$(156) = "0599"
            cat$(157) = "0600"
            cat$(158) = "0602"
            cat$(159) = "0611"
            cat$(160) = "0613"
            cat$(161) = "0615"
            cat$(162) = "0617"
            cat$(163) = "0618"
            cat$(164) = "0622"
            cat$(165) = "0626"
            cat$(166) = "0627"
            cat$(167) = "0628"
            cat$(168) = "0629"
            cat$(169) = "0631"
            cat$(170) = "0636"
            cat$(171) = "0638"
            cat$(172) = "0639"
            cat$(173) = "0640"
            cat$(174) = "0642"
            cat$(175) = "0646"
            cat$(176) = "0647"
            cat$(177) = "0649"
            cat$(178) = "0650"
            cat$(179) = "0652"
            cat$(180) = "0654"
            cat$(181) = "0659"
            cat$(182) = "0671"
            cat$(183) = "0672"
            cat$(184) = "0673"
            cat$(185) = "0674"
            cat$(186) = "0675"
            cat$(187) = "0677"
            cat$(188) = "0678"
            cat$(189) = "0679"
            cat$(190) = "0681"
            cat$(191) = "0682"
            cat$(192) = "0683"
            cat$(193) = "0686"
            cat$(194) = "0689"
            cat$(195) = "0692"
            cat$(196) = "0694"
            cat$(197) = "0697"
            cat$(198) = "0698"
            cat$(199) = "0700"
            cat$(200) = "0701"
            cat$(201) = "0705"
            cat$(202) = "0708"
            cat$(203) = "0709"
            cat$(204) = "0710"
            cat$(205) = "0717"
            cat$(206) = "0720"
            cat$(207) = "0722"
            cat$(208) = "0725"
            cat$(209) = "0726"
            cat$(210) = "0729"
            cat$(211) = "0731"
            cat$(212) = "0733"
            cat$(213) = "0734"
            cat$(214) = "0735"
            cat$(215) = "0741"
            cat$(216) = "0743"
            cat$(217) = "0744"
            cat$(218) = "0745"
            cat$(219) = "0746"
            cat$(220) = "0747"
            cat$(221) = "0748"
            cat$(222) = "0749"
            cat$(223) = "0752"
            cat$(224) = "0754"
            cat$(225) = "0755"
            cat$(226) = "0757"
            cat$(227) = "0759"
            cat$(228) = "0760"
            cat$(229) = "0763"
            cat$(230) = "0764"
            cat$(231) = "0765"
            cat$(232) = "0768"
            cat$(233) = "0769"
            cat$(234) = "0771"
            cat$(235) = "0772"
            cat$(236) = "0773"
            cat$(237) = "0778"
            cat$(238) = "0779"
            cat$(239) = "0780"
            cat$(240) = "0781"
            cat$(241) = "0782"
            cat$(242) = "0786"
            cat$(243) = "0790"
            cat$(244) = "0792"
            cat$(245) = "0796"
            cat$(246) = "0798"
            cat$(247) = "0799"
            cat$(248) = "0809"
            cat$(249) = "0810"
            cat$(250) = "0812"
            cat$(251) = "0813"
            cat$(252) = "0816"
            cat$(253) = "0820"
            cat$(254) = "0821"
            cat$(255) = "0826"
            cat$(256) = "0828"
            cat$(257) = "0829"
            cat$(258) = "0830"
            cat$(259) = "0831"
            cat$(260) = "0832"
            cat$(261) = "0833"
            cat$(262) = "0834"
            cat$(263) = "0839"
            cat$(264) = "0847"
            cat$(265) = "0849"
            cat$(266) = "0850"
            cat$(267) = "0852"
            cat$(268) = "0854"
            cat$(269) = "0855"
            cat$(270) = "0857"
            cat$(271) = "0858"
            cat$(272) = "0859"
            cat$(273) = "0860"
            cat$(274) = "0861"
            cat$(275) = "0862"
            cat$(276) = "0864"
            cat$(277) = "0865"
            cat$(278) = "0866"
            cat$(279) = "0867"
            cat$(280) = "0869"
            cat$(281) = "0870"
            cat$(282) = "0873"
            cat$(283) = "0874"
            cat$(284) = "0876"
            cat$(285) = "0878"
            cat$(286) = "0880"
            cat$(287) = "0885"
            cat$(288) = "0886"
            cat$(289) = "0888"
            cat$(290) = "0889"
            cat$(291) = "0890"
            cat$(292) = "0891"
            cat$(293) = "0892"
            cat$(294) = "0894"
            cat$(295) = "0898"
            cat$(296) = "0899"
            cat$(297) = "0900"
            cat$(298) = "0901"
            cat$(299) = "0905"
            cat$(300) = "0909"
            cat$(301) = "1005"
            cat$(302) = "1009"
            cat$(303) = "1010"
            cat$(304) = "1015"
            cat$(305) = "1016"
            cat$(306) = "1018"
            cat$(307) = "1021"
            cat$(308) = "1026"
            cat$(309) = "1027"
            cat$(310) = "1030"
            cat$(311) = "1032"
            cat$(312) = "1036"
            cat$(313) = "1051"
            cat$(314) = "1052"
            cat$(315) = "1060"
            cat$(316) = "1061"
            cat$(317) = "1068"
            cat$(318) = "1069"
            cat$(319) = "1071"
            cat$(320) = "1074"
            cat$(321) = "1091"
            cat$(322) = "1092"
            cat$(323) = "1096"
            cat$(324) = "1097"
            cat$(325) = "1098"
            cat$(326) = "1102"
            cat$(327) = "1108"
            cat$(328) = "1111"
            cat$(329) = "1112"
            cat$(330) = "1116"
            cat$(331) = "1117"
            cat$(332) = "1119"
            cat$(333) = "1131"
            cat$(334) = "1136"
            cat$(335) = "1139"
            cat$(336) = "1142"
            cat$(337) = "1144"
            cat$(338) = "1145"
            cat$(339) = "1151"
            cat$(340) = "1152"
            cat$(341) = "1156"
            cat$(342) = "1160"
            cat$(343) = "1161"
            cat$(344) = "1162"
            cat$(345) = "1163"
            cat$(346) = "1177"
            cat$(347) = "1181"
            cat$(348) = "1191"
            cat$(349) = "1192"
            cat$(350) = "1208"
            cat$(351) = "1215"
            cat$(352) = "1229"
            cat$(353) = "1234"
            cat$(354) = "1236"
            cat$(355) = "1244"
            cat$(356) = "1248"
            cat$(357) = "1249"
            cat$(358) = "1251"
            cat$(359) = "1252"
            cat$(360) = "1268"
            cat$(361) = "1280"
            cat$(362) = "1284"
            cat$(363) = "1286"
            cat$(364) = "1287"
            cat$(365) = "1289"
            cat$(366) = "1291"
            cat$(367) = "1295"
            cat$(368) = "1297"
            cat$(369) = "1316"
            cat$(370) = "1321"
            cat$(371) = "1323"
            cat$(372) = "1325"
            cat$(373) = "1354"
            cat$(374) = "1359"
            cat$(375) = "1370"
            cat$(376) = "1383"
            cat$(377) = "1396"
            cat$(378) = "1397"
            cat$(379) = "1408"
            cat$(380) = "1415"
            cat$(381) = "1426"
            cat$(382) = "1435"
            cat$(383) = "1439"
            cat$(384) = "1467"
            cat$(385) = "1474"
            cat$(386) = "1476"
            cat$(387) = "1477"
            cat$(388) = "1481"
            cat$(389) = "1482"
            cat$(390) = "1487"
            cat$(391) = "1489"
            cat$(392) = "1495"
            cat$(393) = "1511"
            cat$(394) = "1516"
            cat$(395) = "1517"
            cat$(396) = "1520"
            cat$(397) = "1535"
            cat$(398) = "1538"
            cat$(399) = "1544"
            cat$(400) = "1572"
            cat$(401) = "1573"
            cat$(402) = "1574"
            cat$(403) = "1575"
            cat$(404) = "1576"
            cat$(405) = "1578"
            cat$(406) = "1579"
            cat$(407) = "1580"
            cat$(408) = "1581"
            cat$(409) = "1582"
            cat$(410) = "1583"
            cat$(411) = "1586"
            cat$(412) = "1587"
            cat$(413) = "1588"
            cat$(414) = "1601"
            cat$(415) = "1602"
            cat$(416) = "1606"
            cat$(417) = "1610"
            cat$(418) = "1612"
            cat$(419) = "1616"
            cat$(420) = "1624"
            cat$(421) = "1625"
            cat$(422) = "1633"
            cat$(423) = "1635"
            cat$(424) = "1640"
            cat$(425) = "1641"
            cat$(426) = "1642"
            cat$(427) = "1644"
            cat$(428) = "1645"
            cat$(429) = "1648"
            cat$(430) = "1652"
            cat$(431) = "1654"
            cat$(432) = "1655"
            cat$(433) = "1656"
            cat$(434) = "1657"
            cat$(435) = "1658"
            cat$(436) = "1659"
            cat$(437) = "1670"
            cat$(438) = "1671"
            cat$(439) = "1672"
            cat$(440) = "1677"
            cat$(441) = "1678"
	    cat = 1
L01000:      /* main loop */
            cat$ = cat$(cat)
	    init(" ") pc_key$
	    cnt% = cnt% + 1
            l = 1                  
L01100:
	        pc_key$ = "000000"
                str(pc_key$,7,3) = mdl$(l)          
                read #1, key = pc_key$,hold, using L00020, pc_rec$(),          ~
                                                   eod goto L01200
                sv_key$ = pc_key$
                str(sv_key$,7,3) = mdl$(l)        
	        str(sv_key$,1,4) = cat$
                str(pc_rec$(),7,3) = mdl$(l)        
	        str(pc_rec$(),1,4) = cat$
		gosub update_rec
		l = l + 1
		if l < 04 then goto L01100
L01200:
            cat = cat + 1
            if cat < 442 then goto L01000
	    goto FINI

update_rec:
                read #1,hold, key = sv_key$,hold, using L00030, tmp_key$,      ~
                                                   eod goto L01500
                goto L01800

L01500:
            write #1, using L00020, pc_rec$()
            add% = add% + 1%
            goto L02000
L01800:     rewrite #1, using L00020, pc_rec$()
	    upd% = upd% + 1%
L02000:     return

L00010:      FMT CH(04)
L00020:      FMT 3*CH(256)	
L00030:      FMT CH(09)  
FINI:       print "         records read    = ", cnt%
            print "         records added   = ", add%
            print "         records updated = ", upd%
            end
	      
